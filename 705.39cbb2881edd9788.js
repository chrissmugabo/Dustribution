"use strict";(self.webpackChunktame_accommodation=self.webpackChunktame_accommodation||[]).push([[705],{4705:(q,Z,l)=>{l.r(Z),l.d(Z,{UsersComponent:()=>p});var s=l(6084),y=l(7945),f=l(6814),v=l(9416),w=l(7597),b=l(6166),m=l(6223),C=l(3750),T=l(1384),e=l(9212),U=l(8950),x=l(1474);let A=(()=>{class i{constructor(t){this.http=t}save(t){return this.http.post("users/store",t)}update(t){return this.http.put("users/update",t)}delete(t){return this.http.delete(`users/delete/${t}`)}static#e=this.\u0275fac=function(d){return new(d||i)(e.LFG(x.eN))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var S=l(7911),F=l(7612);const N=["formModal"];function c(i,_){if(1&i&&e._UZ(0,"app-lazy-image",59),2&i){const t=e.oxw().$implicit,d=e.oxw();e.Q6J("src",d.getImageFromServer(null==t?null:t.avatar))}}function g(i,_){if(1&i&&e._UZ(0,"app-user-avatar",60),2&i){const t=e.oxw().$implicit;e.Q6J("name",t.name)}}function o(i,_){1&i&&(e.TgZ(0,"span"),e._UZ(1,"i",61),e._uU(2," Active"),e.qZA())}function r(i,_){1&i&&(e.TgZ(0,"span"),e._UZ(1,"i",62),e._uU(2," Suspended "),e.qZA())}function n(i,_){if(1&i){const t=e.EpF();e.TgZ(0,"tr",45)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.YNc(4,c,1,1,"app-lazy-image",46)(5,g,1,1,"ng-template",null,47,e.W1O),e.TgZ(7,"a",48),e._uU(8),e.qZA()(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.qZA(),e.TgZ(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA(),e.TgZ(17,"td"),e.YNc(18,o,3,0,"span",49)(19,r,3,0,"ng-template",null,50,e.W1O),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td")(24,"div",51)(25,"button",52),e._UZ(26,"i",53),e.qZA(),e.TgZ(27,"ul",54)(28,"li")(29,"a",55),e.NdJ("click",function(){const u=e.CHM(t).$implicit,h=e.oxw();return e.KtG(h.showModal(u))}),e._UZ(30,"i",56),e._uU(31," Edit "),e.qZA()(),e.TgZ(32,"li")(33,"a",57),e.NdJ("click",function(){const u=e.CHM(t).$implicit,h=e.oxw();return e.KtG(h.handleDestroy(u))}),e._UZ(34,"i",58),e._uU(35," Delete "),e.qZA()()()()()()}if(2&i){const t=_.$implicit,d=e.MAs(6),a=e.MAs(20),u=e.oxw();e.xp6(2),e.hij("#",u.padNumber(t.id),""),e.xp6(2),e.Q6J("ngIf",null==t?null:t.avatar)("ngIfElse",d),e.xp6(4),e.Oqu(t.name),e.xp6(2),e.Oqu(null==t?null:t.gender),e.xp6(2),e.Oqu(null==t?null:t.email),e.xp6(2),e.Oqu(null==t?null:t.phone),e.xp6(2),e.Oqu(null==t?null:t.role),e.xp6(1),e.Tol(t.status?"text-success":"text-danger"),e.xp6(1),e.Q6J("ngIf",t.status)("ngIfElse",a),e.xp6(4),e.Oqu(null==t||null==t.creator?null:t.creator.name)}}let p=(()=>{class i{constructor(t,d,a,u,h){this.paginationService=t,this.usersService=d,this.fb=a,this.toastService=u,this.uiService=h,this.rows=[],this.role_id="",this.columns=[{title:"S/N"},{title:"Full Name",sortable:!0},{title:"Gender",sortable:!0},{title:"Email"},{title:"Phone"},{title:"Role",sortable:!0},{title:"Status"},{title:"Created By",sortable:!0}],this.userForm=this.fb.group({id:[0],first_name:["",m.kI.required],last_name:[""],email:["",m.kI.required],gender:[""],phone:[""],password:["",m.kI.required],role_id:[""],address:[""]})}ngOnInit(){this.paginationService.rows$.subscribe(t=>{this.rows=t})}padNumber(t){return y._.padNumber(t)}getImageFromServer(t){return y._.getImageFromServer(t)}showModal(t){t&&(this.userForm.patchValue(t),this.role_id=t.role_id),this.formModal.show()}handleSubmit(){const t=this.userForm.value;t.role_id=this.role_id,this.usersService.save(t).subscribe(d=>{const{user:a}=d,{id:u}=t;if(u){const h=this.rows.findIndex(J=>J.id==u);-1!==h&&(this.rows[h]=a)}else this.rows.unshift(a);this.toastService.setMessage({type:"success",text:"Client saved successfully"}),this.userForm.reset()})}handleDestroy(t){this.uiService.confirm({title:"Deleting a user",content:"Are you sure you want to this user:"+t.name,action:()=>{this.usersService.delete(t.id).subscribe(()=>{const d=this.rows.findIndex(a=>a.id==a.id);-1!==d&&(this.rows.splice(d,1),this.toastService.setMessage({type:"success",text:"Record deleted successfully"}))})}})}static#e=this.\u0275fac=function(d){return new(d||i)(e.Y36(U.N),e.Y36(A),e.Y36(m.qu),e.Y36(S.k),e.Y36(F.F))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-users"]],viewQuery:function(d,a){if(1&d&&e.Gf(N,5),2&d){let u;e.iGM(u=e.CRH())&&(a.formModal=u.first)}},standalone:!0,features:[e.jDz],decls:79,vars:7,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0"],[1,"page-title-right"],[1,"breadcrumb","m-0"],[1,"breadcrumb-item"],["href","javascript: void(0);"],[1,"breadcrumb-item","active"],["url","users",3,"columns"],["href","javascript:void(0)","action","",1,"btn","btn-primary",3,"click"],[1,"ri-add-line","me-1","fs-16","align-middle"],["filters","",1,"d-flex","py-3","align-items-center","gap-3"],["rows","",4,"ngFor","ngForOf"],[3,"customId"],["formModal",""],["title",""],["body",""],[1,"auth-input",3,"formGroup","ngSubmit"],[1,"row","gy-1","gx-1"],[1,"col-6"],[1,"mb-0"],["for","firstName",1,"form-label","required"],["type","text","id","firstName","placeholder","","formControlName","first_name",1,"form-control"],["for","lastname",1,"form-label","required"],["type","text","id","lastname","placeholder","","formControlName","last_name",1,"form-control"],["for","phone",1,"form-label","required"],["type","text","id","phone","placeholder","","formControlName","phone",1,"form-control"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control"],["for","gender",1,"form-label","required"],["id","gender","formControlName","gender",1,"form-select","form-control-lg"],["value","null","hidden","","disabled",""],["value","M"],["value","F"],["for","country",1,"form-label",2,"z-index","1007"],["url","roles","primaryKey","id","label","name","placeholder","Select Role",3,"loadDefaults","selection","selectionChange"],["for","address",1,"form-label"],["type","text","id","address","placeholder","","formControlName","address",1,"form-control"],["for","Password",1,"form-label","required"],["type","password","id","Password","placeholder","","formControlName","password",1,"form-control"],["footer","",1,"row"],["type","button",1,"btn","btn-light","w-100",3,"click"],["task","ADDING_ROOM","classes","btn btn-primary w-100","type","button",1,"w-100",3,"disabled","clicked"],["caption",""],["rows",""],["classes","avatar-xs rounded-circle me-2",3,"src",4,"ngIf","ngIfElse"],["noAvatarImage",""],["href","javascript: void(0);",1,"text-body","align-middle","fw-medium"],[4,"ngIf","ngIfElse"],["userSuspended",""],[1,""],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-soft-primary","btn-sm","dropdown"],[1,"ri-more-fill","align-middle","fs-18"],[1,"dropdown-menu","dropdown-menu-end"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],[1,"ri-pencil-fill","fs-18","align-middle","me-2","text-muted"],["href","javascript:void(0)",1,"dropdown-item","remove-item-btn",3,"click"],[1,"ri-delete-bin-line","fs-18","align-middle","me-2","text-muted"],["classes","avatar-xs rounded-circle me-2",3,"src"],["height","2rem;display: inline-flex;margin-right:0.5rem","width","2rem",3,"name"],[1,"ri-checkbox-circle-line","fs-17","align-middle"],[1,"ri-close-circle-line","fs-17","align-middle"]],template:function(d,a){1&d&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4,"Users List"),e.qZA(),e.TgZ(5,"div",4)(6,"ol",5)(7,"li",6)(8,"a",7),e._uU(9,"Leads"),e.qZA()(),e.TgZ(10,"li",8),e._uU(11,"Users"),e.qZA()()()()()(),e.TgZ(12,"app-pagination",9)(13,"a",10),e.NdJ("click",function(){return a.showModal()}),e._UZ(14,"i",11),e._uU(15," Add User "),e.qZA(),e._UZ(16,"div",12),e.YNc(17,n,36,13,"tr",13),e.qZA(),e.TgZ(18,"app-off-canvas",14,15)(20,"span",16),e._uU(21,"Add a new User"),e.qZA(),e.TgZ(22,"div",17)(23,"form",18),e.NdJ("ngSubmit",function(){return a.handleSubmit()}),e.TgZ(24,"div",19)(25,"div",20)(26,"div",21)(27,"label",22),e._uU(28,"First Name"),e.qZA(),e._UZ(29,"input",23),e.qZA()(),e.TgZ(30,"div",20)(31,"div",21)(32,"label",24),e._uU(33,"Last Name"),e.qZA(),e._UZ(34,"input",25),e.qZA()(),e.TgZ(35,"div",20)(36,"div",21)(37,"label",26),e._uU(38,"Phone"),e.qZA(),e._UZ(39,"input",27),e.qZA()(),e.TgZ(40,"div",20)(41,"div",21)(42,"label",28),e._uU(43,"Email"),e.qZA(),e._UZ(44,"input",29),e.qZA()(),e.TgZ(45,"div",20)(46,"div",21)(47,"label",30),e._uU(48,"Gender"),e.qZA(),e.TgZ(49,"select",31)(50,"option",32),e._uU(51,"Select Gender"),e.qZA(),e.TgZ(52,"option",33),e._uU(53,"Male"),e.qZA(),e.TgZ(54,"option",34),e._uU(55,"Female"),e.qZA()()()(),e.TgZ(56,"div",20)(57,"div",21)(58,"label",35),e._uU(59,"Role"),e.qZA(),e.TgZ(60,"app-custom-select",36),e.NdJ("selectionChange",function(h){return a.role_id=h}),e.qZA()()(),e.TgZ(61,"div",20)(62,"div",21)(63,"label",37),e._uU(64,"Address Line"),e.qZA(),e._UZ(65,"input",38),e.qZA()(),e.TgZ(66,"div",20)(67,"div",21)(68,"label",39),e._uU(69,"Password"),e.qZA(),e._UZ(70,"input",40),e.qZA()()()()(),e.TgZ(71,"div",41)(72,"div",20)(73,"button",42),e.NdJ("click",function(){return a.userForm.reset()}),e._uU(74," Reset "),e.qZA()(),e.TgZ(75,"div",20)(76,"app-button",43),e.NdJ("clicked",function(){return a.handleSubmit()}),e.TgZ(77,"span",44),e._uU(78,"Save"),e.qZA()()()()()),2&d&&(e.xp6(12),e.Q6J("columns",a.columns),e.xp6(5),e.Q6J("ngForOf",a.rows),e.xp6(1),e.Q6J("customId","formModal"),e.xp6(5),e.Q6J("formGroup",a.userForm),e.xp6(37),e.Q6J("loadDefaults",!0)("selection",a.role_id),e.xp6(16),e.Q6J("disabled",!a.userForm.valid||!a.role_id))},dependencies:[s.Q,f.ax,f.O5,v.s,w.k,b.i,C.T,T.r,m.UX,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.sg,m.u]})}return i})()},3750:(q,Z,l)=>{l.d(Z,{T:()=>N});var s=l(9212),y=l(7945),f=l(6223),v=l(6814),w=l(9045),b=l(9397),m=l(1474);let C=(()=>{class c{constructor(o){this.http=o}fetchRecords(o){return this.http.get(o).pipe((0,b.b)(r=>r.rows||r||[]))}static#e=this.\u0275fac=function(r){return new(r||c)(s.LFG(m.eN))};static#t=this.\u0275prov=s.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})();function T(c,g){1&c&&(s.O4$(),s.TgZ(0,"svg",8),s._UZ(1,"path",9),s.qZA())}const e=c=>({active:c});function U(c,g){if(1&c){const o=s.EpF();s.TgZ(0,"button",5),s.NdJ("click",function(){const p=s.CHM(o).$implicit,i=s.oxw();return s.KtG(i.handleChange(p))}),s.YNc(1,T,2,0,"svg",6),s._UZ(2,"span",7),s.qZA()}if(2&c){const o=g.$implicit,r=s.oxw();s.Q6J("ngClass",s.VKq(3,e,r.selectedRow[r.primaryKey]==o[r.primaryKey])),s.xp6(1),s.Q6J("ngIf",r.selectedRow[r.primaryKey]==o[r.primaryKey]),s.xp6(1),s.Q6J("innerHTML",o.alias||o[r.label],s.oJD)}}function x(c,g){1&c&&(s.TgZ(0,"span",10),s._uU(1,"No data to display"),s.qZA())}const A=[[["","footer",""]]],S=(c,g)=>({"rounded-bottom-0":c,"is-loading":g}),F=["[footer]"];let N=(()=>{class c{constructor(o,r){this.apiService=o,this.selectService=r,this.primaryKey="id",this.url="",this.label="name",this.placeholder="select",this.loadDefaults=!1,this.records=[],this.fetchFlag="AUTOCOMPLETE_REQUEST",this.selected=new s.vpe,this.selectionChange=new s.vpe,this.rows=[],this.searchKey=null,this.selectedRow={},this.searchActive=!1}get isProcessing(){return this.apiService.isProcessing(this.fetchFlag)}get filteredRows(){let o=this.rows;const r=this.searchKey&&this.searchKey.toLowerCase();return r&&(o=o.filter(n=>String(n[this.label]).toLowerCase().indexOf(r)>-1)),o}ngOnInit(){if(this.records.length&&(this.rows=[...this.records],this.selection)){const o=this.rows.find(r=>r[this.primaryKey]==this.selection);o&&(this.searchKey=o[this.label],this.selectedRow=o)}this.loadDefaults&&this.handleDataFetch()}ngOnChanges(o){if(o.selection){const r=o.selection.currentValue;if(r||0===r){const n=this.rows.find(p=>p[this.primaryKey]==r);n&&(this.searchKey=n[this.label],this.selectedRow=n)}}o.records&&(this.rows=[...this.rows,...o.records.currentValue])}handleFocusIn(o){const r=o.target;"BUTTON"==r.nodeName?r.click():"INPUT"==r.nodeName&&(this.searchKey=null)}handleFocusOut(o){const r=o.target;("INPUT"==r.nodeName||r.classList.contains("search-item"))&&setTimeout(()=>{this.searchActive=!1},1)}handleDataFetch(o){const r=o||this.url;this.apiService.onGoingRequestFlag=this.fetchFlag,this.selectService.fetchRecords(r).subscribe(n=>{this.rows=[...this.rows,...n]})}handleSearch(o){const n=o.target.value;if(n.trim().length>3&&!this.filteredRows.length&&this.url){const p=y._.encodeQuery(this.url,{query:n});this.handleDataFetch(p)}}handleChange(o){this.searchKey=o[this.label],o[this.primaryKey]!=this.selectedRow[this.primaryKey]&&(this.selectedRow=o,this.selected.emit(o),this.selection=o[this.primaryKey],this.selectionChange.emit(this.selection)),this.searchActive=!1}clearAll(){this.selectedRow={},this.rows=[]}static#e=this.\u0275fac=function(r){return new(r||c)(s.Y36(w.s),s.Y36(C))};static#t=this.\u0275cmp=s.Xpm({type:c,selectors:[["app-custom-select"]],inputs:{selection:"selection",primaryKey:"primaryKey",url:"url",label:"label",placeholder:"placeholder",loadDefaults:"loadDefaults",records:"records",fetchFlag:"fetchFlag"},outputs:{selected:"selected",selectionChange:"selectionChange"},standalone:!0,features:[s.TTD,s.jDz],ngContentSelectors:F,decls:6,vars:8,consts:[[1,"search-field","bs-select"],["data-bs-toggle","dropdown","aria-expanded","false","type","text",1,"form-control","cursor-pointer","search-key-input",3,"placeholder","ngClass","ngModel","focus","ngModelChange","input"],[1,"dropdown-menu","ember-view","scrollmenu","w-100"],["class","dropdown-item search-item pl-7 text-dark","type","button",3,"ngClass","click",4,"ngFor","ngForOf"],["class","py-2",4,"ngIf"],["type","button",1,"dropdown-item","search-item","pl-7","text-dark",3,"ngClass","click"],["version","1.1","xmlns","http://www.w3.org/2000/svg","x","0","y","0","viewBox","0 0 512 512",0,"xml","space","preserve","class","icon icon-ok icon-xs",4,"ngIf"],[3,"innerHTML"],["version","1.1","xmlns","http://www.w3.org/2000/svg","x","0","y","0","viewBox","0 0 512 512",0,"xml","space","preserve",1,"icon","icon-ok","icon-xs"],["d","M503.4 141.1c-5.6-5.6-12.9-8.6-20.8-8.6s-15.3 3.1-20.8 8.6L162.1 440.7 50.2 328.8c-11.5-11.5-30.2-11.5-41.6 0-11.5 11.5-11.5 30.2 0 41.6l132.8 132.9c5.6 5.5 13 8.5 20.8 8.5 7.9 0 15.5-3.2 20.9-8.7l320.4-320.4c11.4-11.5 11.4-30.2-.1-41.6z"],[1,"py-2"]],template:function(r,n){1&r&&(s.F$t(A),s.TgZ(0,"div",0)(1,"input",1),s.NdJ("focus",function(){return n.searchKey="",n.searchActive=!0})("ngModelChange",function(i){return n.searchKey=i})("input",function(i){return n.handleSearch(i)}),s.qZA(),s.TgZ(2,"div",2),s.YNc(3,U,3,5,"button",3)(4,x,2,0,"span",4),s.Hsn(5),s.qZA()()),2&r&&(s.xp6(1),s.Q6J("placeholder",n.placeholder)("ngClass",s.WLB(5,S,n.searchActive,n.isProcessing))("ngModel",n.searchKey),s.xp6(2),s.Q6J("ngForOf",n.filteredRows),s.xp6(1),s.Q6J("ngIf",!n.isProcessing&&!n.filteredRows.length))},dependencies:[f.u5,f.Fj,f.JJ,f.On,v.mk,v.ax,v.O5]})}return c})()}}]);