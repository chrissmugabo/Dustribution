"use strict";(self.webpackChunktame_accommodation=self.webpackChunktame_accommodation||[]).push([[491],{7491:(f,p,s)=>{s.r(p),s.d(p,{BookingsComponent:()=>y});var u=s(6084),g=s(6313),c=s(6814),h=s(8494),o=s(4966),m=s(8105),l=s(6223),b=s(1384),t=s(9212),Z=s(621),C=s(8950),v=s(7911),T=s(7890),E=s(7612);const M=["deleteModal"],A=["checkedModal"];function U(n,_){1&n&&(t.TgZ(0,"span",49),t._uU(1,"Completed"),t.qZA())}function k(n,_){1&n&&(t.TgZ(0,"span",50),t._uU(1,"In House"),t.qZA())}function O(n,_){1&n&&(t.TgZ(0,"span",51)(1,"span",50),t._uU(2,"Check-in Ready"),t.qZA(),t._UZ(3,"span",52),t.qZA())}function x(n,_){1&n&&(t.TgZ(0,"span",51)(1,"span",49),t._uU(2,"Check-out Ready"),t.qZA(),t._UZ(3,"span",52),t.qZA())}function D(n,_){1&n&&(t.TgZ(0,"span",53),t._uU(1,"Pending"),t.qZA())}function I(n,_){1&n&&(t.TgZ(0,"span",54),t._uU(1,"Overdue"),t.qZA())}function R(n,_){1&n&&(t.TgZ(0,"span",49),t._uU(1,"Cancelled"),t.qZA())}function w(n,_){1&n&&(t.TgZ(0,"span",55),t._uU(1,"Draft"),t.qZA())}function B(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"li")(1,"a",56),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openCheckinModal(a))}),t._UZ(2,"i",57),t._uU(3," Check-in "),t.qZA()()}}function P(n,_){if(1&n&&(t.TgZ(0,"tr",32)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"formatMoney"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"formatMoney"),t.qZA(),t.TgZ(19,"td")(20,"div",33),t.YNc(21,U,2,0,"span",34)(22,k,2,0,"span",35)(23,O,4,0,"span",36)(24,x,4,0,"span",36)(25,D,2,0,"span",37)(26,I,2,0,"span",38)(27,R,2,0,"span",34)(28,w,2,0,"span",39),t.qZA()(),t.TgZ(29,"td"),t._uU(30),t.qZA(),t.TgZ(31,"td")(32,"div",40)(33,"button",41),t._UZ(34,"i",42),t.qZA(),t.TgZ(35,"ul",43),t.YNc(36,B,4,0,"li",44),t.TgZ(37,"li")(38,"a",45),t._UZ(39,"i",46),t._uU(40," Edit "),t.qZA()(),t.TgZ(41,"li")(42,"a",47),t._UZ(43,"i",48),t._uU(44," Delete "),t.qZA()()()()()()),2&n){const e=_.$implicit,i=t.oxw();t.xp6(2),t.hij("#",e.id,""),t.xp6(2),t.Oqu(e.room.category),t.xp6(2),t.Oqu(e.room.room_name),t.xp6(2),t.Oqu(null==e.booking||null==e.booking.client?null:e.booking.client.name),t.xp6(2),t.Oqu(i.formatReservationDate(e.start_date)),t.xp6(2),t.Oqu(i.formatReservationDate(e.end_date)),t.xp6(2),t.Oqu(t.lcZ(15,18,e.amount)),t.xp6(3),t.Oqu(t.lcZ(18,20,0)),t.xp6(3),t.Q6J("ngSwitch",e.state),t.xp6(1),t.Q6J("ngSwitchCase","RESOLVED"),t.xp6(1),t.Q6J("ngSwitchCase","OCCUPIED"),t.xp6(1),t.Q6J("ngSwitchCase","READY_FOR_CHECKIN"),t.xp6(1),t.Q6J("ngSwitchCase","READY_FOR_CHECKOUT"),t.xp6(1),t.Q6J("ngSwitchCase","PENDING"),t.xp6(1),t.Q6J("ngSwitchCase","OVERDUE"),t.xp6(1),t.Q6J("ngSwitchCase","CANCELLED"),t.xp6(3),t.Oqu((null==e.booking||null==e.booking.creator?null:e.booking.creator.name)||"--"),t.xp6(6),t.Q6J("ngIf","PENDING"==e.status&&"READY_FOR_CHECKIN"==e.state)}}let y=(()=>{class n{constructor(e,i,a,r,d,q){this.rs=e,this.ps=i,this.ts=a,this.router=r,this.ui=d,this.fb=q,this.rows=[],this.columns=[{title:"S/N"},{title:"Room",sortable:!0},{title:"Room No",sortable:!0},{title:"Guest",sortable:!0},{title:"Check-in"},{title:"Check-out"},{title:"Amount",sortable:!0},{title:"Balance",sortable:!0},{title:"Status",sortable:!0},{title:"Created By",sortable:!0}],this.checkInForm=this.fb.group({id:[0],adults:[1,l.kI.required],children:[0],comment:[""],from:[""],to:[""],name:[""],category:[""]})}ngOnInit(){this.ps.rows$.subscribe(e=>{this.rows=e})}formatReservationDate(e){return g.b.formatDate(e,!0)}navigateToNew(){this.router.navigate([{outlets:{primary:h.n.ROOMS_RESERVATION.path}}])}openCheckinModal(e){const{id:i,start_date:a,end_date:r,room:d}=e;this.checkInForm.get("id")?.patchValue(i),this.checkInForm.get("from")?.patchValue(a),this.checkInForm.get("to")?.patchValue(r),this.checkInForm.get("name")?.patchValue(d.room_name),this.checkInForm.get("category")?.patchValue(d.category),this.checkedModal.show()}delegateCheckinAction(){const e=this.checkInForm.value;this.rs.checkin(e).subscribe({next:()=>{const i=e.id,a=this.rows.findIndex(r=>r.id==i);-1!==a&&(this.rows[a].status="OCCUPIED",this.rows[a].state="OCCUPIED"),this.ts.setMessage({type:"success",text:"Customer checked in successfully"}),this.checkedModal.hide()}})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(Z.D),t.Y36(C.N),t.Y36(v.k),t.Y36(T.F0),t.Y36(E.F),t.Y36(l.qu))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["room-bookings"]],viewQuery:function(i,a){if(1&i&&(t.Gf(M,5),t.Gf(A,5)),2&i){let r;t.iGM(r=t.CRH())&&(a.deleteModal=r.first),t.iGM(r=t.CRH())&&(a.checkedModal=r.first)}},standalone:!0,features:[t.jDz],decls:48,vars:8,consts:[[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0"],[1,"page-title-right"],[1,"breadcrumb","m-0"],[1,"breadcrumb-item"],["href","javascript: void(0);"],[1,"breadcrumb-item","active"],["url","rooms/reserved-rooms",3,"columns"],["href","javascript:void(0)","prevent","","action","",1,"btn","btn-primary",3,"click"],[1,"ri-add-line","me-1","fs-16","align-middle"],["filters","",1,"d-flex","py-3","align-items-center","gap-3"],["rows","",4,"ngFor","ngForOf"],[3,"customId","dialogClasses"],["checkedModal",""],["title",""],["body",""],[3,"formGroup"],[1,"row","gx-1"],[1,"col-12","mb-0"],[1,"col-lg-6"],[1,"mb-"],["for","customer-name",1,"col-form-label"],["type","number","formControlName","adults",1,"form-control"],["type","number","formControlName","children",1,"form-control"],[1,"col-lg-12"],["for","message-text",1,"col-form-label"],["formControlName","comment","rows","2",1,"form-control"],["footer",""],["task","ADDING_ROOM","classes","btn btn-primary w-100","type","button",1,"w-100",3,"disabled","clicked"],["caption",""],["rows",""],[3,"ngSwitch"],["class","badge badge-soft-success fs-12",4,"ngSwitchCase"],["class","badge badge-soft-info fs-12",4,"ngSwitchCase"],["class","position-relative",4,"ngSwitchCase"],["class","badge badge-soft-primary fs-12",4,"ngSwitchCase"],["class","badge text-bg-warning fs-12",4,"ngSwitchCase"],["class","badge badge-soft-dark fs-12",4,"ngSwitchDefault"],[1,""],["type","button","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-soft-primary","btn-sm","dropdown"],[1,"ri-more-fill","align-middle","fs-18"],[1,"dropdown-menu","dropdown-menu-end"],[4,"ngIf"],["href","javascript:void(0);","prevent","",1,"dropdown-item"],[1,"ri-pencil-fill","fs-18","align-middle","me-2","text-muted"],["href","javascript:void(0)","prevent","",1,"dropdown-item","remove-item-btn"],[1,"ri-delete-bin-line","fs-18","align-middle","me-2","text-muted"],[1,"badge","badge-soft-success","fs-12"],[1,"badge","badge-soft-info","fs-12"],[1,"position-relative"],[1,"bull","bull-sm","bg-success","position-absolute","animate-pulse-success","top-0","start-0"],[1,"badge","badge-soft-primary","fs-12"],[1,"badge","text-bg-warning","fs-12"],[1,"badge","badge-soft-dark","fs-12"],["href","javascript:void(0);","prevent","",1,"dropdown-item",3,"click"],[1,"ri-checkbox-circle-line","fs-18","align-middle","me-2","text-muted"]],template:function(i,a){if(1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),t._uU(4,"Room Reservations"),t.qZA(),t.TgZ(5,"div",4)(6,"ol",5)(7,"li",6)(8,"a",7),t._uU(9,"Bookings"),t.qZA()(),t.TgZ(10,"li",8),t._uU(11,"List"),t.qZA()()()()()(),t.TgZ(12,"app-pagination",9)(13,"a",10),t.NdJ("click",function(){return a.navigateToNew()}),t._UZ(14,"i",11),t._uU(15," New Reservation "),t.qZA(),t._UZ(16,"div",12),t.YNc(17,P,45,22,"tr",13),t.qZA(),t.TgZ(18,"app-modal",14,15)(20,"span",16),t._uU(21,"Complete checkin"),t.qZA(),t.TgZ(22,"div",17)(23,"form",18)(24,"div",19)(25,"h6",20),t._uU(26),t.TgZ(27,"small"),t._uU(28),t.qZA()(),t.TgZ(29,"div",21)(30,"div",22)(31,"label",23),t._uU(32,"Adults:"),t.qZA(),t._UZ(33,"input",24),t.qZA()(),t.TgZ(34,"div",21)(35,"div",22)(36,"label",23),t._uU(37,"Children:"),t.qZA(),t._UZ(38,"input",25),t.qZA()()(),t.TgZ(39,"div",26)(40,"div",22)(41,"label",27),t._uU(42,"Comment:"),t.qZA(),t._UZ(43,"textarea",28),t.qZA()()()(),t.TgZ(44,"div",29)(45,"app-button",30),t.NdJ("clicked",function(){return a.delegateCheckinAction()}),t.TgZ(46,"span",31),t._uU(47,"Confirm and Save"),t.qZA()()()()),2&i){let r,d;t.xp6(12),t.Q6J("columns",a.columns),t.xp6(5),t.Q6J("ngForOf",a.rows),t.xp6(1),t.Q6J("customId","checked-modal")("dialogClasses","modal-fullscreen-md-down modal-sm"),t.xp6(5),t.Q6J("formGroup",a.checkInForm),t.xp6(3),t.hij(" Room: ",null==(r=a.checkInForm.get("name"))?null:r.value," "),t.xp6(2),t.hij("(",null==(d=a.checkInForm.get("category"))?null:d.value,")"),t.xp6(17),t.Q6J("disabled",!a.checkInForm.valid)}},dependencies:[u.Q,c.ax,o.l,c.RF,c.n9,c.ED,m.z,b.r,l.UX,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.sg,l.u,c.O5]})}return n})()},4966:(f,p,s)=>{s.d(p,{l:()=>g});var u=s(9212);let g=(()=>{class c{transform(o,...m){return m[0]?"RWF "+this.formatNumber(o):(o.toString().indexOf(".")>-1&&(o=Number(o).toFixed(0)),"RWF "+o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))}formatNumber(o){return 999<Math.abs(o)&&Math.abs(o)<999999?Math.sign(o)*Number((Math.abs(o)/1e3).toFixed(1))+"K":999999<Math.abs(o)&&Math.abs(o)<999999999?Math.sign(o)*Number((Math.abs(o)/1e6).toFixed(1))+"M":999999999<Math.abs(o)&&Math.abs(o)<999999999999?Math.sign(o)*Number((Math.abs(o)/1e9).toFixed(1))+"B":999999999999<Math.abs(o)?Math.sign(o)*Number((Math.abs(o)/1e12).toFixed(1))+"T":""+Math.sign(o)*Math.abs(o)}static#t=this.\u0275fac=function(m){return new(m||c)};static#e=this.\u0275pipe=u.Yjl({name:"formatMoney",type:c,pure:!0,standalone:!0})}return c})()}}]);